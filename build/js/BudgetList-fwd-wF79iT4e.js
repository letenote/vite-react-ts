import{r as e,l as t,k as a,s as o,f as r,b as n,_ as i,j as s,h as l,i as d,a as c,R as p,d as m,u,L as v}from"./vendor-fwd-1SGvIy31.js";import{s as f,n as x,u as j}from"./main-fwd--n1B72RI.js";import{g as h}from"./getBudgets-fwd-KGb_xtEF.js";import{s as g,M as b,T as w}from"./index-fwd-x8ldU6o3.js";import{d as y}from"./Close-fwd-cAl8Tvfj.js";import{A as S,a as C}from"./API-fwd-wSBNwRC-.js";import{h as L}from"./moment-fwd-Q1JHmZVX.js";import{R as B}from"./Permission.enum-fwd-pLKPg_gz.js";import{b as M}from"./index-fwd-lWyokz70.js";import{a as I,b as D,c as R}from"./DialogContent-fwd-CYcOnUyi.js";import{D as N}from"./DialogTitle-fwd-BhLgXYUL.js";import A from"./index-fwd-v2U3PscQ.js";import Y from"./index-fwd-QlVXGDcN.js";import{c as P,S as z}from"./createSvgIcon-fwd-3znVHFND.js";import{D as T}from"./Divider-fwd-L0kvT4D9.js";import k from"./index-fwd-hPOcf5d2.js";import E from"./index-fwd-goasdrlS.js";import{M as $}from"./BudgetCreateAndUpdateDialog-fwd-hcWM3RWY.js";import{M as H}from"./SelectInputDialogType.type-fwd-EhrzjEHx.js";import{S as W}from"./Stack-fwd-_b9icarT.js";import{P as F,a as O}from"./MoreVert-fwd-WWrhY7aJ.js";import"./index-fwd-LcBzpfNx.js";import"./interopRequireDefault-fwd-TQpPSNg9.js";import"./createSvgIcon-fwd-C5HoRyYL.js";import"./Visibility-fwd-Vs-P4HLI.js";import"./BudgetStatus.enum-fwd-ooaJayoQ.js";import"./TrainingStatusType.enum-fwd-N0jD9jO9.js";import"./Menu-fwd-Vl9pMXPK.js";import"./Modal-fwd-p5WxUrg9.js";import"./utils-fwd-Aa8Nbi8J.js";import"./TransitionGroupContext-fwd-AdrtyOFN.js";import"./useSlotProps-fwd-4TF0dLOI.js";import"./Portal-fwd-EmXNK1q8.js";import"./Paper-fwd-WFaa4pXn.js";import"./Grow-fwd-0-97KQP6.js";import"./List-fwd-B3qUSFQa.js";import"./MenuItem-fwd-JVQWDuju.js";import"./index-fwd-8NRQb7QL.js";import"./listItemIconClasses-fwd-R0gCvGgm.js";import"./dividerClasses-fwd-g7uA4vLh.js";import"./listItemTextClasses-fwd-v4LoqRQE.js";import"./ListItem-fwd-iX4GRk4M.js";import"./ListItemAvatar-fwd-_WncWLnl.js";import"./Avatar-fwd-DjoP233w.js";import"./ListItemText-fwd-f8rlfGNg.js";import"./Chip-fwd-PLmggBsV.js";import"./index-fwd-zt72GgeW.js";import"./index-fwd-lbVkD5aF.js";import"./Button-fwd-V0oP7Gqc.js";import"./index.esm-fwd-rj9UIJ_I.js";import"./populateString-fwd-uH2jbhuZ.js";import"./ComponentFormType.enum-fwd-9JVL8E6k.js";import"./index-fwd-x_aeOfk5.js";import"./index-fwd-YZzHoVcr.js";import"./index-fwd-A0-YyUGO.js";import"./InputAdornment-fwd-KneKoIsb.js";const q=e.createContext({}),U=e.createContext({});function J(e){return t("MuiStep",e)}a("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const V=["active","children","className","component","completed","disabled","expanded","index","last"],G=o("div",{name:"MuiStep",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,t[a.orientation],a.alternativeLabel&&t.alternativeLabel,a.completed&&t.completed]}})((({ownerState:e})=>r({},"horizontal"===e.orientation&&{paddingLeft:8,paddingRight:8},e.alternativeLabel&&{flex:1,position:"relative"}))),_=e.forwardRef((function(t,a){const o=n({props:t,name:"MuiStep"}),{active:c,children:p,className:m,component:u="div",completed:v,disabled:f,expanded:x=!1,index:j,last:h}=o,g=i(o,V),{activeStep:b,connector:w,alternativeLabel:y,orientation:S,nonLinear:C}=e.useContext(q);let[L=!1,B=!1,M=!1]=[c,v,f];b===j?L=void 0===c||c:!C&&b>j?B=void 0===v||v:!C&&b<j&&(M=void 0===f||f);const I=e.useMemo((()=>({index:j,last:h,expanded:x,icon:j+1,active:L,completed:B,disabled:M})),[j,h,x,L,B,M]),D=r({},o,{active:L,orientation:S,alternativeLabel:y,completed:B,disabled:M,expanded:x,component:u}),R=(e=>{const{classes:t,orientation:a,alternativeLabel:o,completed:r}=e;return d({root:["root",a,o&&"alternativeLabel",r&&"completed"]},J,t)})(D),N=s.jsxs(G,r({as:u,className:l(R.root,m),ref:a,ownerState:D},g,{children:[w&&y&&0!==j?w:null,p]}));return s.jsx(U.Provider,{value:I,children:w&&!y&&0!==j?s.jsxs(e.Fragment,{children:[w,N]}):N})})),K=P(s.jsx("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"}),"CheckCircle"),Q=P(s.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}),"Warning");function X(e){return t("MuiStepIcon",e)}const Z=a("MuiStepIcon",["root","active","completed","error","text"]);var ee;const te=["active","className","completed","error","icon"],ae=o(z,{name:"MuiStepIcon",slot:"Root",overridesResolver:(e,t)=>t.root})((({theme:e})=>({display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),color:(e.vars||e).palette.text.disabled,[`&.${Z.completed}`]:{color:(e.vars||e).palette.primary.main},[`&.${Z.active}`]:{color:(e.vars||e).palette.primary.main},[`&.${Z.error}`]:{color:(e.vars||e).palette.error.main}}))),oe=o("text",{name:"MuiStepIcon",slot:"Text",overridesResolver:(e,t)=>t.text})((({theme:e})=>({fill:(e.vars||e).palette.primary.contrastText,fontSize:e.typography.caption.fontSize,fontFamily:e.typography.fontFamily}))),re=e.forwardRef((function(e,t){const a=n({props:e,name:"MuiStepIcon"}),{active:o=!1,className:c,completed:p=!1,error:m=!1,icon:u}=a,v=i(a,te),f=r({},a,{active:o,completed:p,error:m}),x=(e=>{const{classes:t,active:a,completed:o,error:r}=e;return d({root:["root",a&&"active",o&&"completed",r&&"error"],text:["text"]},X,t)})(f);if("number"==typeof u||"string"==typeof u){const e=l(c,x.root);return m?s.jsx(ae,r({as:Q,className:e,ref:t,ownerState:f},v)):p?s.jsx(ae,r({as:K,className:e,ref:t,ownerState:f},v)):s.jsxs(ae,r({className:e,ref:t,ownerState:f},v,{children:[ee||(ee=s.jsx("circle",{cx:"12",cy:"12",r:"12"})),s.jsx(oe,{className:x.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:f,children:u})]}))}return u}));function ne(e){return t("MuiStepLabel",e)}const ie=a("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),se=["children","className","componentsProps","error","icon","optional","slotProps","StepIconComponent","StepIconProps"],le=o("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,t[a.orientation]]}})((({ownerState:e})=>r({display:"flex",alignItems:"center",[`&.${ie.alternativeLabel}`]:{flexDirection:"column"},[`&.${ie.disabled}`]:{cursor:"default"}},"vertical"===e.orientation&&{textAlign:"left",padding:"8px 0"}))),de=o("span",{name:"MuiStepLabel",slot:"Label",overridesResolver:(e,t)=>t.label})((({theme:e})=>r({},e.typography.body2,{display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),[`&.${ie.active}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${ie.completed}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${ie.alternativeLabel}`]:{marginTop:16},[`&.${ie.error}`]:{color:(e.vars||e).palette.error.main}}))),ce=o("span",{name:"MuiStepLabel",slot:"IconContainer",overridesResolver:(e,t)=>t.iconContainer})((()=>({flexShrink:0,display:"flex",paddingRight:8,[`&.${ie.alternativeLabel}`]:{paddingRight:0}}))),pe=o("span",{name:"MuiStepLabel",slot:"LabelContainer",overridesResolver:(e,t)=>t.labelContainer})((({theme:e})=>({width:"100%",color:(e.vars||e).palette.text.secondary,[`&.${ie.alternativeLabel}`]:{textAlign:"center"}}))),me=e.forwardRef((function(t,a){var o;const c=n({props:t,name:"MuiStepLabel"}),{children:p,className:m,componentsProps:u={},error:v=!1,icon:f,optional:x,slotProps:j={},StepIconComponent:h,StepIconProps:g}=c,b=i(c,se),{alternativeLabel:w,orientation:y}=e.useContext(q),{active:S,disabled:C,completed:L,icon:B}=e.useContext(U),M=f||B;let I=h;M&&!I&&(I=re);const D=r({},c,{active:S,alternativeLabel:w,completed:L,disabled:C,error:v,orientation:y}),R=(e=>{const{classes:t,orientation:a,active:o,completed:r,error:n,disabled:i,alternativeLabel:s}=e;return d({root:["root",a,n&&"error",i&&"disabled",s&&"alternativeLabel"],label:["label",o&&"active",r&&"completed",n&&"error",i&&"disabled",s&&"alternativeLabel"],iconContainer:["iconContainer",o&&"active",r&&"completed",n&&"error",i&&"disabled",s&&"alternativeLabel"],labelContainer:["labelContainer",s&&"alternativeLabel"]},ne,t)})(D),N=null!=(o=j.label)?o:u.label;return s.jsxs(le,r({className:l(R.root,m),ref:a,ownerState:D},b,{children:[M||I?s.jsx(ce,{className:R.iconContainer,ownerState:D,children:s.jsx(I,r({completed:L,active:S,error:v,icon:M},g))}):null,s.jsxs(pe,{className:R.labelContainer,ownerState:D,children:[p?s.jsx(de,r({ownerState:D},N,{className:l(R.label,null==N?void 0:N.className),children:p})):null,x]})]}))}));me.muiName="StepLabel";const ue=me;function ve(e){return t("MuiStepConnector",e)}a("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const fe=["className"],xe=o("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,t[a.orientation],a.alternativeLabel&&t.alternativeLabel,a.completed&&t.completed]}})((({ownerState:e})=>r({flex:"1 1 auto"},"vertical"===e.orientation&&{marginLeft:12},e.alternativeLabel&&{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"}))),je=o("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.line,t[`line${c(a.orientation)}`]]}})((({ownerState:e,theme:t})=>{const a="light"===t.palette.mode?t.palette.grey[400]:t.palette.grey[600];return r({display:"block",borderColor:t.vars?t.vars.palette.StepConnector.border:a},"horizontal"===e.orientation&&{borderTopStyle:"solid",borderTopWidth:1},"vertical"===e.orientation&&{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24})})),he=e.forwardRef((function(t,a){const o=n({props:t,name:"MuiStepConnector"}),{className:p}=o,m=i(o,fe),{alternativeLabel:u,orientation:v="horizontal"}=e.useContext(q),{active:f,disabled:x,completed:j}=e.useContext(U),h=r({},o,{alternativeLabel:u,orientation:v,active:f,completed:j,disabled:x}),g=(e=>{const{classes:t,orientation:a,alternativeLabel:o,active:r,completed:n,disabled:i}=e,s={root:["root",a,o&&"alternativeLabel",r&&"active",n&&"completed",i&&"disabled"],line:["line",`line${c(a)}`]};return d(s,ve,t)})(h);return s.jsx(xe,r({className:l(g.root,p),ref:a,ownerState:h},m,{children:s.jsx(je,{className:g.line,ownerState:h})}))}));function ge(e){return t("MuiStepper",e)}a("MuiStepper",["root","horizontal","vertical","alternativeLabel"]);const be=["activeStep","alternativeLabel","children","className","component","connector","nonLinear","orientation"],we=o("div",{name:"MuiStepper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,t[a.orientation],a.alternativeLabel&&t.alternativeLabel]}})((({ownerState:e})=>r({display:"flex"},"horizontal"===e.orientation&&{flexDirection:"row",alignItems:"center"},"vertical"===e.orientation&&{flexDirection:"column"},e.alternativeLabel&&{alignItems:"flex-start"}))),ye=s.jsx(he,{}),Se=e.forwardRef((function(t,a){const o=n({props:t,name:"MuiStepper"}),{activeStep:c=0,alternativeLabel:p=!1,children:m,className:u,component:v="div",connector:f=ye,nonLinear:x=!1,orientation:j="horizontal"}=o,h=i(o,be),g=r({},o,{alternativeLabel:p,orientation:j,component:v}),b=(e=>{const{orientation:t,alternativeLabel:a,classes:o}=e;return d({root:["root",t,a&&"alternativeLabel"]},ge,o)})(g),w=e.Children.toArray(m).filter(Boolean),y=w.map(((t,a)=>e.cloneElement(t,r({index:a,last:a+1===w.length},t.props)))),S=e.useMemo((()=>({activeStep:c,alternativeLabel:p,connector:f,nonLinear:x,orientation:j})),[c,p,f,x,j]);return s.jsx(q.Provider,{value:S,children:s.jsx(we,r({as:v,ownerState:g,className:l(b.root,u),ref:a},h,{children:y}))})})),Ce=["Review","Approve"],Le=e=>{let t=[];return null!==e.rejectedByChrmo&&t.push("reject"),null!==e.rejectedByCfo&&t.push("reject"),t.length>0},Be=(e,t)=>!(e<1)&&(null!==t.rejectedByCfo||null!==t.rejectedByChrmo),Me=e=>null===e.reviewBy?0:null!==e.approvedByChrmo||null!==e.approvedByCfo?2:null===e.approvedByChrmo||null===e.approvedByCfo?1:0,Ie={fontSize:"12px",fontWeight:"100",display:"flex",flexDirection:"column"},De=p.memo((t=>{const a=new URLSearchParams(location.search),o=parseInt(a.get("page")||"1",10),r=x(),{user:n}=j((e=>e.settings)),i=m(),l=M(i.breakpoints.down("md")),[d,c]=e.useState({loading:!1});return s.jsxs(I,{id:"budget-create-dialog",fullScreen:l,fullWidth:!0,maxWidth:"sm","aria-labelledby":"budget-create-dialog",disableEscapeKeyDown:!0,open:t.open,children:[s.jsx(N,{sx:{m:0,p:2},id:"customized-dialog-title",children:"Budget Detail"}),s.jsx(A,{"aria-label":"close",onClick:t.closeEvent,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:s.jsx(y,{})}),s.jsx(D,{dividers:!0,sx:{pb:"45px"},children:s.jsxs(Y,{sx:{mt:1},children:[!t.data.isDraft&&s.jsx(Se,{activeStep:Me(t.data),alternativeLabel:!0,children:Ce.map(((e,a)=>s.jsx(_,{children:s.jsx(ue,{error:Be(a,t.data),children:s.jsxs(Y,{sx:{display:"flex",flexDirection:"column"},children:[s.jsx("span",{children:1===a&&Le(t.data)?"Reject":e}),0===a&&null!==t.data.reviewBy&&s.jsxs(Y,{sx:Ie,children:[s.jsx("span",{children:t.data.reviewBy.name}),s.jsx("span",{children:L(t.data.reviewAt).format("DD/MM/YYYY")})]}),1===a&&null!==t.data.rejectedByChrmo&&s.jsxs(Y,{sx:Ie,children:[s.jsx("span",{children:t.data.rejectedByChrmo.name}),s.jsx("span",{children:L(t.data.rejectedByChrmoAt).format("DD/MM/YYYY")})]}),1===a&&null!==t.data.rejectedByCfo&&s.jsxs(Y,{sx:Ie,children:[s.jsx("span",{children:t.data.rejectedByCfo.name}),s.jsx("span",{children:L(t.data.rejectedByCfoAt).format("DD/MM/YYYY")})]}),1===a&&null!==t.data.approvedByChrmo&&s.jsxs(Y,{sx:Ie,children:[s.jsx("span",{children:t.data.approvedByChrmo.name}),s.jsx("span",{children:L(t.data.approvedByChrmoAt).format("DD/MM/YYYY")})]}),1===a&&null!==t.data.approvedByCfo&&s.jsxs(Y,{sx:Ie,children:[s.jsx("span",{children:t.data.approvedByCfo.name}),s.jsx("span",{children:L(t.data.approvedByCfoAt).format("DD/MM/YYYY")})]})]})})},e)))}),!t.data.isDraft&&s.jsx(T,{variant:"middle",sx:{mt:4,mb:4,ml:0,mr:0}}),s.jsx(k,{variant:"h6",gutterBottom:!0,children:t.data.name}),s.jsxs(k,{variant:"subtitle1",display:"block",gutterBottom:!0,children:["Cost:"," ",new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(t.data.cost))]}),s.jsxs(k,{variant:"caption",gutterBottom:!0,sx:{mb:4},children:["Request by, ",t.data.requestBy.name," (",t.data.requestBy.departement.name,") at"," ",L(t.data.createdAt).format("DD MMM YYYY"),"."]}),s.jsx(k,{variant:"subtitle1",gutterBottom:!0,sx:{mt:2},children:"Information:"}),s.jsx(k,{variant:"subtitle1",gutterBottom:!0,children:t.data.information}),2===Me(t.data)&&s.jsxs(p.Fragment,{children:[s.jsx(k,{variant:"subtitle1",gutterBottom:!0,sx:{mt:2},children:"Budget code :"}),s.jsx(k,{variant:"subtitle1",gutterBottom:!0,sx:{fontWeight:900},children:t.data.code})]})]})}),s.jsxs(R,{children:[n.role===B.HRO&&null===t.data.reviewBy&&s.jsx(E,{loading:d.loading,disabled:d.loading,variant:"contained",size:"medium",onClick:()=>{c({loading:!0});const e={budgetId:t.data.id,isReviewed:!0};var a;r((a={data:e,successCB:()=>{c({loading:!0}),t.closeEvent(),r(h({page:o}))}},async e=>{var t;try{return await new Promise((e=>setTimeout(e,1e3))),await S({method:"post",url:"/v1/budgets/update/review",payload:a.data}),e(f({open:!0,autoHideDuration:3e3,severity:"success",message:"Budget reviewed"})),a.successCB()}catch(o){C.isAxiosError(o)&&o.response&&(console.log("errr",(null==(t=o.response)?void 0:t.data).error),e(f({open:!0,autoHideDuration:3e3,severity:"warning",message:o.message})))}}))},children:s.jsx(k,{variant:"button",display:"block",gutterBottom:!0,children:"Review"})}),(n.role===B.CHRMO||n.role===B.CFO)&&null!==t.data.reviewBy&&s.jsxs(p.Fragment,{children:[g(t.data)&&s.jsx(E,{loading:d.loading,disabled:d.loading,variant:"outlined",size:"medium",onClick:()=>{c({loading:!0});const e={budgetId:t.data.id,isReject:!0};var a;r((a={data:e,successCB:()=>{c({loading:!0}),t.closeEvent(),r(h({page:o}))}},async e=>{var t;try{return await new Promise((e=>setTimeout(e,1e3))),await S({method:"post",url:"/v1/budgets/update/reject",payload:a.data}),e(f({open:!0,autoHideDuration:3e3,severity:"success",message:"Budget rejected"})),a.successCB()}catch(o){C.isAxiosError(o)&&o.response&&(console.log("errr",(null==(t=o.response)?void 0:t.data).error),e(f({open:!0,autoHideDuration:3e3,severity:"warning",message:o.message})))}}))},children:s.jsx(k,{variant:"button",display:"block",gutterBottom:!0,children:"Reject"})}),g(t.data)&&s.jsx(E,{loading:d.loading,disabled:d.loading,variant:"contained",size:"medium",onClick:()=>{c({loading:!0});const e={budgetId:t.data.id,isApprove:!0};var a;r((a={data:e,successCB:()=>{c({loading:!0}),t.closeEvent(),r(h({page:o}))}},async e=>{var t;try{return await new Promise((e=>setTimeout(e,1e3))),await S({method:"post",url:"/v1/budgets/update/approve",payload:a.data}),e(f({open:!0,autoHideDuration:3e3,severity:"success",message:"Budget approved"})),a.successCB()}catch(o){C.isAxiosError(o)&&o.response&&(console.log("errr",(null==(t=o.response)?void 0:t.data).error),e(f({open:!0,autoHideDuration:3e3,severity:"warning",message:o.message})))}}))},children:s.jsx(k,{variant:"button",display:"block",gutterBottom:!0,children:"Approve"})})]})]})]})}),((e,t)=>JSON.stringify(e)===JSON.stringify(t))),Re=e=>!0,Ne=e=>"hd"===e,Ae=p.memo((()=>{const t=x(),{budget:a}=j((e=>e.pages)),{user:o}=j((e=>e.settings)),r=u(),n=new URLSearchParams(r.search),i=parseInt(n.get("page")||"1",10);e.useEffect((()=>{t(h({page:i,startDate:"",endDate:""}))}),[t,i]);const[l,d]=e.useState({open:!1,listIndex:0}),[c,m]=e.useState({open:!1,listIndex:0});return s.jsxs(p.Fragment,{children:[s.jsx(b,{impl:w.BUDGET_PAGE,headers:["Name","Status","Request By","Used","Cost","Created At"],getValue:["name","status","requestBy.name","training","cost","createdAt"],datas:a.list,loading:a.listLoading,useAction:!0,action:{view:{use:Re(o.role),onClick:e=>(e=>d({open:!0,listIndex:e}))(e)},edit:{use:Ne(o.role),onClick:e=>(e=>m({open:!0,listIndex:e}))(e)}}}),s.jsx(W,{spacing:2,sx:{alignItems:"center",mt:3},children:s.jsx(F,{page:i,count:a.totalPage,onChange:(e,a)=>{t(h({page:a}))},renderItem:e=>s.jsx(O,{component:v,to:"/budget"+(1===e.page?"":`?page=${e.page}`),...e})})}),l.open&&s.jsx(De,{open:l.open,closeEvent:()=>d({open:!1,listIndex:0}),data:a.list[l.listIndex]}),c.open&&s.jsx($,{methodType:H.UPDATE,open:c.open,closeEvent:()=>m({open:!1,listIndex:0}),populate:a.list[c.listIndex]})]})}),((e,t)=>JSON.stringify(e)===JSON.stringify(t)));export{Ae as default};
