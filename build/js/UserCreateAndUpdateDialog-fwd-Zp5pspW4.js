import{R as e,r as a,d as t,j as l}from"./vendor-fwd-1SGvIy31.js";import{d as i}from"./Close-fwd-cAl8Tvfj.js";import{C as o}from"./ComponentFormType.enum-fwd-9JVL8E6k.js";import{S as r,M as s}from"./SelectInputDialogType.type-fwd-EhrzjEHx.js";import{a as n}from"./index.esm-fwd-rj9UIJ_I.js";import{c as d,a as p}from"./populateString-fwd-uH2jbhuZ.js";import{s as u,u as m,n as v}from"./main-fwd--n1B72RI.js";import{S as c}from"./index-fwd-qYMhiIGX.js";import{S as g}from"./index-fwd-w_QQ1xSL.js";import{A as f,a as y}from"./API-fwd-wSBNwRC-.js";import{g as T}from"./getUsers-fwd-mHeYBOiX.js";import{b}from"./index-fwd-lWyokz70.js";import{a as h,b as D,c as I}from"./DialogContent-fwd-CYcOnUyi.js";import{D as x}from"./DialogTitle-fwd-BhLgXYUL.js";import j from"./index-fwd-v2U3PscQ.js";import S from"./index-fwd-QlVXGDcN.js";import w from"./index-fwd-hPOcf5d2.js";import{b as E}from"./index-fwd-YZzHoVcr.js";import C from"./index-fwd-goasdrlS.js";const q={personalData:{name:{id:"name",name:"name",fullWidth:!0,label:"Name",placeholder:"Name",required:!0,errorMessage:"name required",value:"",disabled:!1,type:"text",componentType:o.INPUT_TEXT,autoFocus:!0,autoComplete:"",validate:{pattern:{value:/^/,message:""}},options:[]},gender:{id:"gender",name:"gender",fullWidth:!0,label:"Gender",placeholder:"Gender",required:!0,errorMessage:"gender required",value:"",disabled:!1,type:"select",componentType:o.INPUT_DROPDOWN,autoFocus:!1,autoComplete:"",validate:{pattern:{value:/^/,message:""}},options:[{value:"male",label:"Male"},{value:"female",label:"Female"}]},nik:{id:"nik",name:"nik",fullWidth:!0,label:"Nik",placeholder:"Nik",required:!0,errorMessage:"nik required",value:"",disabled:!1,type:"text",componentType:o.INPUT_TEXT,autoFocus:!1,autoComplete:"",validate:{pattern:{value:/^/,message:""}},options:[]},email:{id:"email",name:"email",fullWidth:!0,label:"Email",placeholder:"email corporate",required:!0,errorMessage:"email required",value:"",disabled:!1,type:"email",componentType:o.INPUT_TEXT,autoFocus:!1,autoComplete:"new-email",validate:{pattern:{value:/[^\s@]+@[^\s@]+\.[^\s@]+/gi,message:"Invalid email format"}},options:[]},activated:{id:"activated",name:"activated",fullWidth:!0,label:"Activated",placeholder:"activated",required:!0,errorMessage:"activated required",value:"active",disabled:!1,type:"select",componentType:o.INPUT_DROPDOWN,autoFocus:!1,autoComplete:"",validate:{pattern:{value:/^/,message:""}},options:[{value:"active",label:"Active"},{value:"inactive",label:"InActive"}]}},detailInformation:{role:{id:"role",name:"role",fullWidth:!0,label:"Role",placeholder:"Role",required:!0,errorMessage:"role required",value:"",disabled:!1,type:"select",componentType:o.INPUT_SELECT_MODAL,autoFocus:!1,autoComplete:"",validate:{pattern:{value:/^/,message:""}},options:[],SelectInputDialogType:r.ROLE},departement:{id:"departement",name:"departement",fullWidth:!0,label:"Departement",placeholder:"Departement",required:!0,errorMessage:"departement required",value:"",disabled:!1,type:"select",componentType:o.INPUT_SELECT_MODAL,autoFocus:!1,autoComplete:"",validate:{pattern:{value:/^/,message:""}},options:[],SelectInputDialogType:r.DEPARTEMENT},division:{id:"division",name:"division",fullWidth:!0,label:"Division",placeholder:"Division",required:!0,errorMessage:"division required",value:"",disabled:!1,type:"select",componentType:o.INPUT_SELECT_MODAL,autoFocus:!1,autoComplete:"",validate:{pattern:{value:/^/,message:""}},options:[],SelectInputDialogType:r.DIVISION},position:{id:"position",name:"position",fullWidth:!0,label:"Position",placeholder:"Position",required:!0,errorMessage:"position required",value:"",disabled:!1,type:"select",componentType:o.INPUT_SELECT_MODAL,autoFocus:!1,autoComplete:"",validate:{pattern:{value:/^/,message:""}},options:[],SelectInputDialogType:r.POSITION},level:{id:"level",name:"level",fullWidth:!0,label:"Level",placeholder:"Level",required:!0,errorMessage:"level required",value:"",disabled:!1,type:"select",componentType:o.INPUT_SELECT_MODAL,autoFocus:!1,autoComplete:"",validate:{pattern:{value:/^/,message:""}},options:[],SelectInputDialogType:r.LEVEL}}},N=e.memo((e=>{const[N,P]=a.useState({loading:!1}),{selectInputOptions:M}=m((e=>e.components)),O=v(),L=JSON.parse(JSON.stringify(q)),k=n({defaultValues:async()=>{var a,t,l,i,o,r,n,d,p,u;return e.methodType===s.UPDATE&&(L.personalData.email.value=(null==(a=e.populate)?void 0:a.email)||"",L.personalData.nik.value=(null==(t=e.populate)?void 0:t.nik)||"",L.personalData.name.value=(null==(l=e.populate)?void 0:l.name)||"",L.personalData.gender.value=(null==(i=e.populate)?void 0:i.gender)||"",L.personalData.activated.value=(null==(o=e.populate)?void 0:o.isActive)?"active":"inactive",L.detailInformation.role.value=(null==(r=e.populate)?void 0:r.role.name)??"",L.detailInformation.departement.value=(null==(n=e.populate)?void 0:n.departement.name)??"",L.detailInformation.division.value=(null==(d=e.populate)?void 0:d.division.name)??"",L.detailInformation.position.value=(null==(p=e.populate)?void 0:p.position.name)??"",L.detailInformation.level.value=(null==(u=e.populate)?void 0:u.level.name)??""),L}}),{register:A,handleSubmit:U,formState:_,control:W,setValue:F,clearErrors:R}=k,{errors:B}=_,$=t(),H=b($.breakpoints.down("md"));return l.jsx(l.Fragment,{children:l.jsxs(h,{component:"form",id:"user-create-dialog",onSubmit:U((a=>{var t,l,i,o,r,n;const d=new URLSearchParams(location.search),p=parseInt(d.get("page")||"1",10);P({loading:!0});const m={name:a.personalData.name.value.toString(),nik:a.personalData.nik.value.toString(),email:a.personalData.email.value.toString(),gender:a.personalData.gender.value.toString(),isActive:"active"===a.personalData.activated.value,roleId:M.role.loading?(null==(t=e.populate)?void 0:t.role.id)??"":M.role.list.filter((e=>e.name===a.detailInformation.role.value))[0].id,departementId:M.departement.loading?(null==(l=e.populate)?void 0:l.departement.id)??"":M.departement.list.filter((e=>e.name===a.detailInformation.departement.value))[0].id,divisionId:M.division.loading?(null==(i=e.populate)?void 0:i.division.id)??"":M.division.list.filter((e=>e.name===a.detailInformation.division.value))[0].id,positionId:M.position.loading?(null==(o=e.populate)?void 0:o.position.id)??"":M.position.list.filter((e=>e.name===a.detailInformation.position.value))[0].id,levelId:M.level.loading?(null==(r=e.populate)?void 0:r.level.id)??"":M.level.list.filter((e=>e.name===a.detailInformation.level.value))[0].id};return e.methodType===s.UPDATE?O((v={data:{...m,id:(null==(n=e.populate)?void 0:n.id)||""},successCB:()=>{e.closeEvent(),O(T({page:p}))},failedCB:()=>{P({loading:!1})}},async e=>{var a,t;try{return await new Promise((e=>setTimeout(e,1e3))),await f({method:"post",url:"/v1/users/update",payload:v.data}),e(u({open:!0,autoHideDuration:3e3,severity:"success",message:"User updated"})),v.successCB()}catch(l){return y.isAxiosError(l)&&l.response&&(console.log("errr",(null==(a=l.response)?void 0:a.data).error),e(u({open:!0,autoHideDuration:3e3,severity:"warning",message:(null==(t=l.response)?void 0:t.data.message)??l.message??""}))),v.failedCB()}})):O((e=>async a=>{var t,l;try{return await new Promise((e=>setTimeout(e,1e3))),await f({method:"post",url:"/v1/users/register",payload:e.data}),a(u({open:!0,autoHideDuration:3e3,severity:"success",message:"User created"})),e.successCB()}catch(i){return y.isAxiosError(i)&&i.response&&(console.log("errr",(null==(t=i.response)?void 0:t.data).error),a(u({open:!0,autoHideDuration:3e3,severity:"warning",message:(null==(l=i.response)?void 0:l.data.message)??i.message??""}))),e.failedCB()}})({data:m,successCB:()=>{e.closeEvent(),O(T({page:p}))},failedCB:()=>{P({loading:!1})}}));var v}),(e=>{console.log("ERROR",{errors:e,form:k}),O(u({open:!0,autoHideDuration:2e3,severity:"warning",message:"Please make sure all forms to be filled"}))})),fullScreen:H,fullWidth:!0,maxWidth:"md",onClose:()=>{},"aria-labelledby":"user-create-dialog",disableEscapeKeyDown:!0,open:e.open,children:[l.jsx(x,{sx:{m:0,p:2},id:"customized-dialog-title",children:`${d(e.methodType)} User`}),l.jsx(j,{"aria-label":"close",onClick:e.closeEvent,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:l.jsx(i,{})}),l.jsx(D,{dividers:!0,sx:{pb:"45px"},children:l.jsx(S,{sx:{mt:1},children:Object.keys(L).map(((e,a)=>{const t=L[e];return l.jsxs(S,{sx:{mb:5},children:[l.jsx(w,{variant:"subtitle1",gutterBottom:!0,children:p(e)}),Object.keys(t).map(((a,i)=>{var s,n;const d=t[a],p=`${e}.${a}.value`,u=null==(s=B[e])?void 0:s[a];switch(d.componentType){case o.INPUT_DROPDOWN:return l.jsx(g,{name:d.name,registerField:p,id:d.id,label:d.label,required:d.required,control:W,error:!!u,helperText:d.errorMessage,value:d.value.toString(),style:{marginLeft:i%2==0?0:3,width:i%2==0?"50%":"47%"},options:d.options,disabled:d.disabled},i);case o.INPUT_SELECT_MODAL:return l.jsx(c,{name:d.name,registerField:p,id:d.id,label:d.label,required:d.required,value:d.value.toString(),error:!!u,control:W,helperText:d.errorMessage,style:{marginLeft:i%2==0?0:3,width:i%2==0?"50%":"47%"},disabled:d.disabled,onSelect:e=>{F(p,e),R(p)},SelectInputDialogType:d.SelectInputDialogType||r.DEPARTEMENT},i);default:return l.jsx(E,{margin:"normal",sx:{ml:{xs:0,md:i%2==0?0:3},width:{xs:"100%",md:i%2==0?"50%":"47%"}},fullWidth:d.fullWidth,label:`${d.label}${d.required?"*":""}`,type:d.type,autoFocus:d.autoFocus,autoComplete:d.autoComplete,...A(p,{required:{value:d.required,message:d.errorMessage},disabled:d.disabled,pattern:{value:d.validate.pattern.value,message:d.validate.pattern.message}}),error:!!u,helperText:(null==(n=null==u?void 0:u.value)?void 0:n.message)??""},i)}}))]},a)}))})}),l.jsxs(I,{children:[l.jsx(C,{loading:!1,disabled:N.loading,variant:"outlined",size:"medium",onClick:e.closeEvent,children:l.jsx(w,{variant:"button",display:"block",gutterBottom:!0,children:"Cancel"})}),l.jsx(C,{type:"submit",loading:N.loading,disabled:N.loading,variant:"contained",size:"medium",children:l.jsx(w,{variant:"button",display:"block",gutterBottom:!0,children:e.methodType})})]})]})})}),((e,a)=>JSON.stringify(e)===JSON.stringify(a)));export{N as M};
