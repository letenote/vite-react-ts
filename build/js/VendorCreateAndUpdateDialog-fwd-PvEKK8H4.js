import{R as e,d as a,r as o,j as r}from"./vendor-fwd-1SGvIy31.js";import{d as t}from"./Close-fwd-cAl8Tvfj.js";import{a as s}from"./index.esm-fwd-rj9UIJ_I.js";import{c as i,a as l}from"./populateString-fwd-uH2jbhuZ.js";import{s as d,n,u as p}from"./main-fwd--n1B72RI.js";import{C as u}from"./ComponentFormType.enum-fwd-9JVL8E6k.js";import{S as m,M as c}from"./SelectInputDialogType.type-fwd-EhrzjEHx.js";import{S as v}from"./index-fwd-w_QQ1xSL.js";import{S as g}from"./index-fwd-qYMhiIGX.js";import{A as f,a as y}from"./API-fwd-wSBNwRC-.js";import{g as T}from"./getVendors-fwd-qqJy-Hwd.js";import{M as h}from"./index-fwd-x_aeOfk5.js";import{b}from"./index-fwd-lWyokz70.js";import{a as x,b as j,c as w}from"./DialogContent-fwd-CYcOnUyi.js";import{D}from"./DialogTitle-fwd-BhLgXYUL.js";import E from"./index-fwd-v2U3PscQ.js";import C from"./index-fwd-QlVXGDcN.js";import I from"./index-fwd-hPOcf5d2.js";import{b as S}from"./index-fwd-YZzHoVcr.js";import P from"./index-fwd-goasdrlS.js";const q={vendorData:{name:{id:"name",name:"name",fullWidth:!0,label:"Name",placeholder:"Name",required:!0,errorMessage:"name required",value:"",disabled:!1,type:"text",componentType:u.INPUT_TEXT,autoFocus:!0,autoComplete:"",validate:{pattern:{value:/^/,message:""}},options:[]},activated:{id:"activated",name:"activated",fullWidth:!0,label:"Activated",placeholder:"activated",required:!0,errorMessage:"activated required",value:"active",disabled:!1,type:"select",componentType:u.INPUT_DROPDOWN,autoFocus:!1,autoComplete:"",validate:{pattern:{value:/^/,message:""}},options:[{value:"active",label:"Active"},{value:"inactive",label:"InActive"}]},vendorType:{id:"vendorType",name:"vendorType",fullWidth:!0,label:"Vendor Type",placeholder:"Vendor Type",required:!0,errorMessage:"vendorType required",value:"",disabled:!1,type:"select",componentType:u.INPUT_SELECT_MODAL,autoFocus:!1,autoComplete:"",validate:{pattern:{value:/^/,message:""}},options:[],SelectInputDialogType:m.VENDOR_TYPE}},detailInformation:{email:{id:"email",name:"email",fullWidth:!0,label:"Email",placeholder:"email corporate",required:!0,errorMessage:"email required",value:"",disabled:!1,type:"email",componentType:u.INPUT_TEXT,autoFocus:!1,autoComplete:"new-email",validate:{pattern:{value:/[^\s@]+@[^\s@]+\.[^\s@]+/gi,message:"Invalid email format"}},options:[]},phone:{id:"phone",name:"phone",fullWidth:!0,label:"Phone",placeholder:"Phone",required:!0,errorMessage:"phone required",value:"",disabled:!1,type:"number",componentType:u.INPUT_TEXT,autoFocus:!1,autoComplete:"",validate:{pattern:{value:/^/,message:""}},options:[]},address:{id:"address",name:"address",fullWidth:!0,label:"Address",placeholder:"Address",required:!0,errorMessage:"address required",value:"",disabled:!1,type:"text",componentType:u.INPUT_TEXT_AREA,autoFocus:!1,autoComplete:"",validate:{pattern:{value:/^/,message:""}},options:[]}}},A=e.memo((e=>{const A=n(),{selectInputOptions:N}=p((e=>e.components)),M=a(),O=b(M.breakpoints.down("md")),_=JSON.parse(JSON.stringify(q)),F=s({defaultValues:async()=>{var a,o,r,t,s,i;return e.methodType===c.UPDATE&&(_.vendorData.name.value=(null==(a=e.populate)?void 0:a.name)??"",_.vendorData.vendorType.value=(null==(o=e.populate)?void 0:o.vendorType.name)??"",_.vendorData.activated.value=(null==(r=e.populate)?void 0:r.isActive)?"active":"inactive",_.detailInformation.email.value=(null==(t=e.populate)?void 0:t.email)??"",_.detailInformation.phone.value=(null==(s=e.populate)?void 0:s.phone)??"",_.detailInformation.address.value=(null==(i=e.populate)?void 0:i.address)??""),_}}),{register:W,handleSubmit:U,formState:B,control:R,setValue:V,clearErrors:k}=F,{errors:L}=B,[$,H]=o.useState({loading:!1});return r.jsx(r.Fragment,{children:r.jsxs(x,{component:"form",id:"vendor-create-dialog",onSubmit:U((a=>{var o,r;console.log("VALID",{data:a});const t=new URLSearchParams(location.search),s=parseInt(t.get("page")||"1",10);H({loading:!0});const i={name:a.vendorData.name.value.toString(),isActive:"active"===a.vendorData.activated.value,address:a.detailInformation.address.value.toString(),email:a.detailInformation.email.value.toString(),phone:a.detailInformation.phone.value.toString(),vendorTypeId:N.vendorType.loading?(null==(o=e.populate)?void 0:o.vendorType.id)??"":N.vendorType.list.filter((e=>e.name===a.vendorData.vendorType.value))[0].id};return e.methodType===c.UPDATE?A((l={data:{...i,id:(null==(r=e.populate)?void 0:r.id)??""},successCB:()=>{e.closeEvent(),A(T({page:s}))},failedCB:()=>{H({loading:!1})}},async e=>{var a,o;try{return await new Promise((e=>setTimeout(e,1e3))),await f({method:"post",url:"/v1/vendors/update",payload:l.data}),e(d({open:!0,autoHideDuration:3e3,severity:"success",message:"Vendor updated"})),l.successCB()}catch(r){return y.isAxiosError(r)&&r.response&&(console.log("errr",(null==(a=r.response)?void 0:a.data).error),e(d({open:!0,autoHideDuration:3e3,severity:"warning",message:(null==(o=r.response)?void 0:o.data.message)??r.message??""}))),l.failedCB()}})):A((e=>async a=>{var o,r;try{return console.log("CreateVendorParamType",{param:e}),await new Promise((e=>setTimeout(e,1e3))),await f({method:"post",url:"/v1/vendors/register",payload:e.data}),a(d({open:!0,autoHideDuration:3e3,severity:"success",message:"Vendor created"})),e.successCB()}catch(t){return y.isAxiosError(t)&&t.response&&(console.log("errr",(null==(o=t.response)?void 0:o.data).error),a(d({open:!0,autoHideDuration:3e3,severity:"warning",message:(null==(r=t.response)?void 0:r.data.message)??t.message??""}))),e.failedCB()}})({data:i,successCB:()=>{e.closeEvent(),A(T({page:s}))},failedCB:()=>{H({loading:!1})}}));var l}),(e=>{console.log("ERROR",{errors:e,form:F}),A(d({open:!0,autoHideDuration:2e3,severity:"warning",message:"Please make sure all forms to be filled"}))})),fullScreen:O,fullWidth:!0,maxWidth:"md",onClose:()=>{},"aria-labelledby":"vendor-create-dialog",disableEscapeKeyDown:!0,open:e.open,children:[r.jsx(D,{sx:{m:0,p:2},id:"customized-dialog-title",children:`${i(e.methodType)} vendor`}),r.jsx(E,{"aria-label":"close",onClick:e.closeEvent,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:r.jsx(t,{})}),r.jsx(j,{dividers:!0,sx:{pb:"45px"},children:r.jsx(C,{sx:{mt:1},children:Object.keys(_).map(((e,a)=>{const o=_[e];return r.jsxs(C,{sx:{mb:5},children:[r.jsx(I,{variant:"subtitle1",gutterBottom:!0,children:l(e)}),Object.keys(o).map(((a,t)=>{var s,i;const l=o[a],d=`${e}.${a}.value`,n=null==(s=L[e])?void 0:s[a];switch(l.componentType){case u.INPUT_DROPDOWN:return r.jsx(v,{name:l.name,registerField:d,id:l.id,label:l.label,required:l.required,control:R,error:!!n,helperText:l.errorMessage,value:l.value,style:{marginLeft:t%2==0?0:3,width:t%2==0?"50%":"47%"},options:l.options,disabled:l.disabled},t);case u.INPUT_SELECT_MODAL:return r.jsx(g,{name:l.name,registerField:d,id:l.id,label:l.label,required:l.required,value:l.value,error:!!n,control:R,helperText:l.errorMessage,style:{marginLeft:t%2==0?0:3,width:t%2==0?"50%":"47%"},disabled:l.disabled,onSelect:e=>{V(d,e),k(d)},SelectInputDialogType:l.SelectInputDialogType??m.DEPARTEMENT},t);case u.INPUT_TEXT_AREA:return r.jsx(h,{name:l.name,registerField:d,id:l.id,label:l.label,required:l.required,control:R,error:!!n,helperText:l.errorMessage,value:l.value,style:{marginLeft:t%2==0?0:3,width:t%2==0?"50%":"47%"},options:l.options,disabled:l.disabled},t);default:return r.jsx(S,{margin:"normal",sx:{ml:{xs:0,md:t%2==0?0:3},width:{xs:"100%",md:t%2==0?"50%":"47%"}},fullWidth:l.fullWidth,label:`${l.label}${l.required?"*":""}`,type:l.type,autoFocus:l.autoFocus,autoComplete:l.autoComplete,...W(d,{required:{value:l.required,message:l.errorMessage},disabled:l.disabled,pattern:{value:l.validate.pattern.value,message:l.validate.pattern.message}}),error:!!n,helperText:(null==(i=null==n?void 0:n.value)?void 0:i.message)??""},t)}}))]},a)}))})}),r.jsxs(w,{children:[r.jsx(P,{loading:!1,disabled:$.loading,variant:"outlined",size:"medium",onClick:e.closeEvent,children:r.jsx(I,{variant:"button",display:"block",gutterBottom:!0,children:"Cancel"})}),r.jsx(P,{type:"submit",loading:$.loading,disabled:$.loading,variant:"contained",size:"medium",children:r.jsx(I,{variant:"button",display:"block",gutterBottom:!0,children:e.methodType})})]})]})})}),((e,a)=>JSON.stringify(e)===JSON.stringify(a)));export{A as M};
